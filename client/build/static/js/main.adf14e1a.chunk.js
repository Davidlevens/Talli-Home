(this.webpackJsonpmern=this.webpackJsonpmern||[]).push([[0],{165:function(e,t,a){e.exports=a(331)},329:function(e,t,a){},330:function(e,t,a){},331:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),o=a(19),s=a(47),c=a(31),i=a(20),u=function(){var e=new i.Browser("jwt");return e.getToken()?{firstName:e.getClaim("firstName"),role:e.getClaim("role"),id:e.getClaim("sub")}:null},m={details:u()},d={user:m},p=Object(s.b)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return new i.Browser("jwt",t.payload.tokens.user),new i.Browser("refreshJwt",t.payload.tokens.refresh),Object(c.a)({},e,{details:u()});case"LOGOUT":var a=new i.Browser("jwt");a.getToken()&&a.eject();var n=new i.Browser("refreshJwt");return n.getToken()&&n.eject(),Object(c.a)({},e,{details:u()});default:return Object(c.a)({},e,{details:u()})}}});var h,E=(h=d,Object(s.c)(p,h,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),b=a(108),f=a(14),g=a(32),v=a(333),w=a(334),k=a(160),y=a(335),N=a(336);function C(e){return r.a.createElement(v.a,null,r.a.createElement(w.a,null,r.a.createElement(k.a,null,r.a.createElement(y.a,{fluid:!0,className:"mt-4"},r.a.createElement("h1",{className:"text-center"},"Love To Read?")),r.a.createElement(w.a,{className:"text-center"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"submit",className:"btn btn-primary",onClick:function(){return e.history.push("/signup")}},"Signup")),r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"submit",className:"btn btn-primary",onClick:function(){return e.history.push("/login")}},"Login"))),r.a.createElement(y.a,{fluid:!0,className:"mt-4"},r.a.createElement("h1",{className:"text-center"},"We got you Cover to Cover!")))))}var j=a(26),O=a.n(j),B=a(338),L=a(339),S=a(81),x=a(21),I=function(e){return{type:"LOGIN",payload:{tokens:e}}},T=function(){return{type:"LOGOUT"}},R=a(38),q=a.n(R),_={getBooks:function(){return F.get("/books")},getBook:function(e){return F.get("/books/"+e)},deleteBook:function(e){return F.delete("/books/"+e)},saveBook:function(e){return F.post("/books",e)}},F=q.a.create({baseURL:"/api/protected"});function G(){var e=new i.Browser("jwt");if(e.getToken()&&e.valid())return Promise.resolve(z(e));var t=new i.Browser("refreshJwt");return t.getToken()?t.valid()?q.a.post("/api/auth/refresh",{token:t.getToken()}).then((function(e){return e.data})).then((function(e){return e.success?(new i.Browser("refreshJwt",e.tokens.refresh),z(new i.Browser("jwt",e.tokens.user))):Promise.reject(e.errors.token)})):Promise.reject("Refresh token not valid on client."):Promise.reject("Refresh token not found on client.")}function z(e){return{Authorization:"Bearer "+e.getToken()}}F.interceptors.request.use((function(e){var t,a;return O.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=q.a.CancelToken.source(),n.prev=1,n.next=4,O.a.awrap(G());case 4:a=n.sent,n.next=12;break;case 7:return n.prev=7,n.t0=n.catch(1),E.dispatch({type:"LOGOUT"}),t.cancel("Request canceled: ".concat(n.t0)),n.abrupt("return",{cancelToken:t.token});case 12:return e.headers=Object(c.a)({},e.headers,{},a),n.abrupt("return",e);case 14:case"end":return n.stop()}}),null,null,[[1,7]])}));var U=Object(c.a)({signup:function(e){return q.a.post("/api/auth/signup",e).then((function(e){return e.data}))},login:function(e){return q.a.post("/api/auth/login",e).then((function(e){return e.data}))}},_),D=a(337);function P(e){return r.a.createElement("div",{className:"form-group"},r.a.createElement("input",Object.assign({className:"form-control"},e)))}function A(e){return r.a.createElement("div",{className:"form-group"},r.a.createElement("textarea",Object.assign({className:"form-control",rows:"20"},e)))}function J(e){return r.a.createElement("button",Object.assign({},e,{style:{float:"right",marginBottom:10},className:"btn btn-success"}),e.children)}function V(e){var t=e.axiosError;if(!t||!t.response)return null;var a,n=t.response,l=n.statusText,o=n.status;return a=t.response.data.error?t.response.data.error:t,r.a.createElement(D.a,{variant:"danger"},o," ",l,r.a.createElement("br",null),"Error Name: ",a.name,r.a.createElement("br",null),"Error Message: ",a.message)}var W=x.object({username:x.string().required(),password:x.string().required()}),H=Object(o.b)(null,{onLogin:I})((function(e){return r.a.createElement(B.a,{show:!0,onHide:function(){return e.history.push("/")},animation:!1,size:"lg","aria-labelledby":"login-form",centered:!0},r.a.createElement(B.a.Header,{closeButton:!0},r.a.createElement(B.a.Title,{id:"login-form"},"Reading List Login")),r.a.createElement(B.a.Body,null,r.a.createElement("h5",{className:"card-title"},"Login to your reading list"),r.a.createElement(S.a,{initialValues:{username:"",password:""},validationSchema:W,onSubmit:function(t,a){var n;return O.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,O.a.awrap(U.login(t));case 3:(n=r.sent).success?e.onLogin(n.tokens):a.setErrors(n.errors),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),a.setStatus(r.t0);case 10:return r.abrupt("return");case 11:case"end":return r.stop()}}),null,null,[[0,7]])}},(function(e){var t=e.status,a=e.values,n=e.errors,l=e.touched,o=e.handleChange,s=e.handleBlur,c=e.handleSubmit,i=e.isSubmitting;return r.a.createElement(L.a,{noValidate:!0,onSubmit:c},r.a.createElement(V,{axiosError:t}),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"username"},r.a.createElement(L.a.Label,null,"Username"),r.a.createElement(L.a.Control,{required:!0,name:"username",autoComplete:"username",placeholder:"Username",onChange:o,onBlur:s,value:a.username,isInvalid:!!n.username}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.username&&l.username&&n.username))),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"Password"},r.a.createElement(L.a.Label,null,"Password"),r.a.createElement(L.a.Control,{autoComplete:"current-password",required:!0,name:"password",type:"password",onChange:o,onBlur:s,value:a.password,isInvalid:!!n.password}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.password&&l.password&&n.password))),r.a.createElement(N.a,{type:"submit",className:"btn btn-primary",disabled:i},"Submit"))})),r.a.createElement(f.b,{className:"link",to:"/signup"},"Don't have an account? ",r.a.createElement("span",{className:"link-signup"},"Signup"))))})),M=a(69),X=a(78),$=a(79),K=a(83),Q=a(80),Y=a(84);a(329);var Z=function(e){return r.a.createElement("span",Object.assign({className:"delete-btn"},e,{role:"button",tabIndex:"0"}),"\u2717")};var ee=function(e){var t=e.children;return r.a.createElement("div",{style:{height:300,clear:"both",paddingTop:120,textAlign:"center"},className:"jumbotron"},t)};function te(e){var t=e.fluid,a=e.children;return r.a.createElement("div",{className:"container".concat(t?"-fluid":"")},a)}function ae(e){var t=e.fluid,a=e.children;return r.a.createElement("div",{className:"row".concat(t?"-fluid":"")},a)}function ne(e){var t=e.size,a=e.children;return r.a.createElement("div",{className:t.split(" ").map((function(e){return"col-"+e})).join(" ")},a)}a(330);function re(e){var t=e.children;return r.a.createElement("div",{className:"list-overflow-container"},r.a.createElement("ul",{className:"list-group"},t))}function le(e){var t=e.children;return r.a.createElement("li",{className:"list-group-item"},t)}var oe=function(e){function t(){var e,a;Object(X.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={books:[],title:"",author:"",synopsis:""},a.loadBooks=function(){U.getBooks().then((function(e){return a.setState({books:e.data,title:"",author:"",synopsis:""})})).catch((function(e){return console.log(e)}))},a.deleteBook=function(e){U.deleteBook(e).then((function(e){return a.loadBooks()})).catch((function(e){return console.log(e)}))},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(M.a)({},n,r))},a.handleFormSubmit=function(e){e.preventDefault(),a.state.title&&a.state.author&&U.saveBook({title:a.state.title,author:a.state.author,synopsis:a.state.synopsis}).then((function(e){return a.loadBooks()})).catch((function(e){return console.log(e)}))},a}return Object(Y.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){this.loadBooks()}},{key:"render",value:function(){var e=this;return r.a.createElement(te,{fluid:!0},r.a.createElement(ae,null,r.a.createElement(ne,{size:"md-6"},r.a.createElement(ee,null,r.a.createElement("h1",null,"What Books Should I Read?")),r.a.createElement("form",null,r.a.createElement(P,{value:this.state.title,onChange:this.handleInputChange,name:"title",placeholder:"Title (required)"}),r.a.createElement(P,{value:this.state.author,onChange:this.handleInputChange,name:"author",placeholder:"Author (required)"}),r.a.createElement(A,{value:this.state.synopsis,onChange:this.handleInputChange,name:"synopsis",placeholder:"Synopsis (Optional)"}),r.a.createElement(J,{disabled:!(this.state.author&&this.state.title),onClick:this.handleFormSubmit},"Submit Book"))),r.a.createElement(ne,{size:"md-6 sm-12"},r.a.createElement(ee,null,r.a.createElement("h1",null,"Books On My List")),this.state.books.length?r.a.createElement(re,null,this.state.books.map((function(t){return r.a.createElement(le,{key:t._id},r.a.createElement(f.b,{to:"/books/"+t._id},r.a.createElement("strong",null,t.title," by ",t.author)),r.a.createElement(Z,{onClick:function(){return e.deleteBook(t._id)}}))}))):r.a.createElement("h3",null,"No Results to Display"))))}}]),t}(n.Component),se=function(e){function t(){var e,a;Object(X.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={book:{}},a}return Object(Y.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){var e=this;U.getBook(this.props.match.params.id).then((function(t){e.setState({book:t.data})}))}},{key:"render",value:function(){return r.a.createElement(te,{fluid:!0},r.a.createElement(ae,null,r.a.createElement(ne,{size:"md-12"},r.a.createElement(ee,null,r.a.createElement("h1",null,this.state.book.title," by ",this.state.book.author)))),r.a.createElement(ae,null,r.a.createElement(ne,{size:"md-10 md-offset-1"},r.a.createElement("article",null,r.a.createElement("h1",null,"Synopsis"),r.a.createElement("p",null,this.state.book.synopsis)))),r.a.createElement(ae,null,r.a.createElement(ne,{size:"md-2"},r.a.createElement(f.b,{to:"/"},"\u2190 Back to Authors"))))}}]),t}(n.Component);var ce=function(){return r.a.createElement(te,{fluid:!0},r.a.createElement(ae,null,r.a.createElement(ne,{size:"md-12"},r.a.createElement(ee,null,r.a.createElement("h1",null,"404 Page Not Found"),r.a.createElement("h1",null,r.a.createElement("span",{role:"img","aria-label":"Face With Rolling Eyes Emoji"},"\ud83d\ude44"))))))},ie=a(340),ue=Object(o.b)((function(e){return{user:e.user.details}}),{onLogout:T})((function(e){return r.a.createElement(ie.a,{className:"navbar-expand-lg navbar-dark bg-primary justify-content-between"},r.a.createElement(ie.a.Brand,{href:"/"},"React Reading List"),e.user?r.a.createElement(N.a,{onClick:e.onLogout},"Logout"):r.a.createElement(f.b,{to:"/login"},r.a.createElement(N.a,null,"Login")))})),me=x.object({firstName:x.string().required(),lastName:x.string().required(),email:x.string().required().email(),username:x.string().required().min(3),password:x.string().required().min(8)}),de=Object(o.b)(null,{onLogin:I})((function(e){return r.a.createElement(B.a,{show:!0,onHide:function(){return e.history.push("/")},animation:!1,size:"lg","aria-labelledby":"signup-form",centered:!0},r.a.createElement(B.a.Header,{closeButton:!0},r.a.createElement(B.a.Title,{id:"signup-form"},"Reading List Signup")),r.a.createElement(B.a.Body,null,r.a.createElement("h5",{className:"card-title"},"Signup to create your reading list"),r.a.createElement(S.a,{initialValues:{firstName:"",lastName:"",email:"",username:"",password:""},validationSchema:me,onSubmit:function(t,a){var n;return O.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,O.a.awrap(U.signup(t));case 3:(n=r.sent).success?e.onLogin(n.tokens):a.setErrors(n.errors),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),a.setStatus(r.t0);case 10:return r.abrupt("return");case 11:case"end":return r.stop()}}),null,null,[[0,7]])}},(function(e){var t=e.status,a=e.values,n=e.errors,l=e.touched,o=e.handleChange,s=e.handleBlur,c=e.handleSubmit,i=e.isSubmitting;return r.a.createElement(L.a,{noValidate:!0,onSubmit:c},r.a.createElement(V,{axiosError:t}),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"signupFirstName"},r.a.createElement(L.a.Label,null,"First name"),r.a.createElement(L.a.Control,{required:!0,autoComplete:"given-name",name:"firstName",type:"text",placeholder:"First name",onChange:o,onBlur:s,value:a.firstName,isInvalid:!!n.firstName}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.firstName&&l.firstName&&n.firstName))),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"signupLastName"},r.a.createElement(L.a.Label,null,"Last name"),r.a.createElement(L.a.Control,{required:!0,autoComplete:"family-name",name:"lastName",type:"text",placeholder:"Last name",onChange:o,onBlur:s,value:a.lastName,isInvalid:!!n.lastName}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.lastName&&l.lastName&&n.lastName))),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"signupEmail"},r.a.createElement(L.a.Label,null,"Email address"),r.a.createElement(L.a.Control,{required:!0,autoComplete:"email",name:"email",type:"email",placeholder:"Email address",onChange:o,onBlur:s,value:a.email,isInvalid:!!n.email}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.email&&l.email&&n.email))),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"username"},r.a.createElement(L.a.Label,null,"Username"),r.a.createElement(L.a.Control,{required:!0,name:"username",autoComplete:"username",placeholder:"Username",onChange:o,onBlur:s,value:a.username,isInvalid:!!n.username}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.username&&l.username&&n.username))),r.a.createElement(L.a.Row,null,r.a.createElement(L.a.Group,{as:k.a,controlId:"Password"},r.a.createElement(L.a.Label,null,"Password"),r.a.createElement(L.a.Control,{required:!0,autoComplete:"new-password",name:"password",type:"password",onChange:o,onBlur:s,value:a.password,isInvalid:!!n.password}),r.a.createElement(L.a.Control.Feedback,{type:"invalid"},n.password&&l.password&&n.password))),r.a.createElement(N.a,{type:"submit",className:"btn btn-primary",disabled:i},"Submit"))})),r.a.createElement(f.b,{className:"link",to:"/login"},"Already have an account? ",r.a.createElement("span",{className:"link-signup"},"Login"))))}));function pe(){return r.a.createElement(f.a,null,r.a.createElement("div",null,r.a.createElement(ue,null),r.a.createElement(g.d,null,r.a.createElement(Ee,{exact:!0,path:"/",component:C}),r.a.createElement(Ee,{path:"/login",component:H}),r.a.createElement(Ee,{path:"/signup",component:de}),r.a.createElement(he,{exact:!0,path:"/books",component:oe}),r.a.createElement(he,{path:"/books/:id",component:se}),r.a.createElement(g.b,{path:"*"},r.a.createElement(ce,null)))))}var he=Object(o.b)((function(e){return{user:e.user.details}}))((function(e){var t=e.component,a=Object(b.a)(e,["component"]);return r.a.createElement(g.b,Object.assign({},a,{render:function(e){return a.user?r.a.createElement(t,e):r.a.createElement(g.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}));var Ee=Object(o.b)((function(e){return{user:e.user.details}}))((function(e){var t=e.component,a=Object(b.a)(e,["component"]);return r.a.createElement(g.b,Object.assign({},a,{render:function(e){return a.user?r.a.createElement(g.a,{to:{pathname:"/books"}}):r.a.createElement(t,e)}}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(l.render)(r.a.createElement(o.a,{store:E},r.a.createElement(pe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[165,1,2]]]);
//# sourceMappingURL=main.adf14e1a.chunk.js.map